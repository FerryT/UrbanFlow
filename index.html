<html>
<head>
	<title>Urban flow</title>
	<meta charset="utf-8">
	<script src="resources/d3.min.js" charset="utf-8"></script>
	<script src="resources/jquery-1.12.2.min.js"></script>
	<script src="resources/ui/jquery-ui.min.js"></script>
	<link rel="stylesheet" href="resources/ui/jquery-ui.min.css">
	<link rel="stylesheet" href="resources/ui/jquery-ui.structure.min.css">
	<link rel="stylesheet" href="resources/ui/jquery-ui.theme.min.css">
	<script src="resources/wewo.js"></script>

	<script src="resources/rasterizer.js"></script>
	<script src="resources/heuristics.js"></script>
	<script src="resources/aco.js"></script>

	<script src="resources/interface.js"></script>
	<link rel="stylesheet" href="resources/interface.css">
	<script src="resources/visuals.js"></script>
	<link rel="stylesheet" href="resources/visuals.css">
</head>
<body>
	<header>
		<h1></h1>
	</header>
	<section id="properties">
		<div id="proptabs">
			<h3>General</h3>
			<div>
				<h4>Simulation:</h4>
				<div id="btns-state">
					<input type="radio" id="rad-start" name="state" value="start"><label for="rad-start">Go</label>
					<input type="radio" id="rad-stop" name="state" value="stop"><label for="rad-stop">Halt</label>
				</div>
			</div>
			<h3>Algorithm</h3>
			<div>&nbsp;</div>
		</div>
	</section>
	<section id="content">
		<div id="document">
			<svg id="field" width="600" height="600"></svg>
		</div>
	</section>
	<section id="toolbar">
		<div id="btns-tools" class="ui-widget-header ui-corner-all">
			<input type="radio" id="rad-road" name="tool" value="road"><label for="rad-road">Roads</label>
			<input type="radio" id="rad-pavement" name="tool" value="pavement"><label for="rad-pavement">Pavements</label>
			<input type="radio" id="rad-building" name="tool" value="building"><label for="rad-building">Buildings</label>
		</div>
	</section>
	<footer>
		<small>By Ferry Timmers and Maurice Houben, March 2016</small>
	</footer>
	<script>
		var domain = [0, 0, 600, 600],
			resolution = [100, 100],
			grid = Rasterize(function (){}, domain, resolution),
			settings = {
				trail_default:   Number.MIN_VALUE,
				trail_minimum:   1e-1,
				trail_power:     0.5,
				trail_decay:     0.5,
				trail_reward:    0.5,
				heuristic_power: 0.5,
				iteration_limit: 100000,
				ant_count:       25,
			},
			aco = new ACO(grid, settings, Heuristic.cosine_distance),
			field = new Field('field', aco, domain, resolution);
		aco
			.addSource(grid.lookup(0, 0), 100)
			.addTarget(grid.lookup(Infinity, Infinity), 100)
		;
		window.requestAnimationFrame(function render()
		{
			field.draw();
			window.requestAnimationFrame(render);
		});

		$('#btns-state input').change(function ()
		{
			if (this.value == 'start')
				aco.go();
			else if (this.value == 'stop')
				aco.halt();
		});
	</script>
</body>
</html>